## 列表

![image-20210509204139221](https://raw.githubusercontent.com/louisyanglu/TyporaImages/master/20210509204142.png)

------

## 赋值、切片、拷贝

### 赋值

1.  **缓存范围**内的 **<u>不可变对象</u> 的赋值**都是同一个对象（可用`is`判断）

    1.  整型数字的缓存范围为**[-5, 256]**
    2.  字符串默认缓存长度**4096**

    ```python
    # 字符串赋值
    str_a = str_b = 'a' * 4097
    str_c = 'a' * 4097
    print(str_b is str_a)  # 输出: True
    print(str_c is str_a)  # 输出：False，这里输出False是因为虽然str_c和str_a的值相等，但长度在为4097，超过了缓存最大长度4096
    ```

2.  **可变对象的赋值**，**比浅拷贝还要浅拷贝**，一个变，另一个也会变

### 切片

>   **切片相当于浅拷贝**

1.  子元素是**不可变元素**，一个变，另一个不变

2.  子元素是**可变元素**，一个变，另一个也变

    ```python
    # 1.操作不可变子元素
    list_a = [1, 2, 3, 4]
    list_b = list_a[:] # 完全切片
    print(list_b is list_a) # 输出False，list_a和list_b是不同的对象
    list_a.append(5)
    print(list_a) # 输出[1, 2, 3, 4, 5]
    print(list_b) # 输出[1, 2, 3, 4]
    
    # 2.操作可变子元素
    list_a = [1, 2, [3], 4]
    list_b = list_a[:] # 完全切片
    print(list_b is list_a) # 输出False，list_a和list_b是不同的对象
    list_a[2].append(44)
    print(list_a)  # 输出[1, 2, [3, 44], 4]
    print(list_b)  # 输出[1, 2, [3, 44], 4]
    ```

### 拷贝

>   **浅拷贝：`copy.copy()`**
>
>   **深拷贝：`copy.deepcopy()`**

1.  **浅拷贝不可变对象，类似于深拷贝**，是**同一**对象

2.  **浅拷贝可变对象，类似于完全切片**，不是同一对象

    ```python
    import copy
    
    a = [1, [2, [3, [4]]]]
    b = copy.copy(a)
    print(b is a)  # 输出False，浅拷贝 可变对象，不是同一对象
    print(b[0] is a[0])  # True，浅拷贝 不可变子元素，是同一对象，这和 深拷贝是一样 的
    print(b[1] is a[1])  # True，浅拷贝 可变子元素，是同一对象，这和 深拷贝是不一样 的
    
    ```

3.  **深拷贝不可变对象，是同一对象**，**深拷贝不可变子元素是同一对象**

4.  **深拷贝可变对象，不是同一对象**，**深拷贝可变子元素是不同的对象**

### 总结

1.  **赋值 **<u>**不可变对象**</u> 要看是否有**缓存机制**来决定是否是同一对象
2.  **赋值** <u>**可变对象**</u> 相当于**引用**，完全不拷贝
3.  **切片**相当于**浅拷贝**
4.  **浅拷贝** **<u>不可变对象</u>** ，相当于**深拷贝**
5.  **浅拷贝** **<u>可变对象</u>** ，修改 **<u>不可变子元素</u>** ，另一个**不变**
6.  **浅拷贝** **<u>可变对象</u>** ，修改 **<u>可变子元素</u>** ，另一个**变**
7.  **深拷贝**任何修改，另一个**不变**

------

